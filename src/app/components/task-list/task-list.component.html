<div class="task-columns-container">
  <!-- Colonne 1: Tri et ajout de tâches -->
  <div class="task-column">
    <h1>Mes tâches</h1>
    <mat-form-field class="full-width">
      <mat-label>Nouvelle tâche</mat-label>
      <input
        matInput
        [(ngModel)]="newTaskTitle"
        name="newTaskTitle"
        placeholder="Entrez une tâche..."
        (keyup.enter)="addTask()"
      />
      <button mat-icon-button matSuffix color="primary" (click)="addTask()">
        <mat-icon>add</mat-icon>
      </button>
    </mat-form-field>
  </div>

  <!-- Colonne 2: Toutes les tâches -->
  <div class="task-column">
    <h2>Toutes</h2>
    <!-- Message si aucune tâche -->
    <div
      *ngIf="filteredTasks.all.length === 0 && !loading"
      class="empty-tasks-message"
    >
      <mat-icon>info</mat-icon>
      <p>Aucune tâche disponible</p>
    </div>
    <!-- Liste des tâches -->
    <div class="task-scroll-container">
      <mat-list *ngIf="filteredTasks.all.length > 0">
        <mat-list-item *ngFor="let task of filteredTasks.all" class="task-item">
          <div class="task-content">
            <!-- Informations de la tâche -->
            <div class="task-info">
              <div class="task-title-container">
                <span class="task-title" [class.completed]="task.completed">{{
                  task.title
                }}</span>
                <span class="task-date">{{ task.dueDate | date }}</span>
              </div>
              <mat-icon
                [color]="task.completed ? 'primary' : 'default'"
                class="status-icon"
              >
                {{ task.completed ? "check_circle" : "more_horiz" }}
              </mat-icon>
            </div>

            <!-- Actions sur la tâche -->
            <div class="task-actions">
              <button
                mat-icon-button
                [routerLink]="['/tasks', task.id]"
                color="primary"
              >
                <mat-icon>visibility</mat-icon>
              </button>
              <button
                mat-icon-button
                [routerLink]="['/tasks', task.id, 'edit']"
                color="primary"
              >
                <mat-icon>edit</mat-icon>
              </button>
              <button
                mat-icon-button
                (click)="deleteTask(task.id)"
                color="warn"
              >
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
        </mat-list-item>
      </mat-list>
    </div>
  </div>

  <!-- Colonne 3: Tâches en cours -->
  <div class="task-column">
    <h2>En cours</h2>
    <!-- Message si aucune tâche -->
    <div
      *ngIf="filteredTasks.pending.length === 0 && !loading"
      class="empty-tasks-message"
    >
      <mat-icon>info</mat-icon>
      <p>Aucune tâche en cours</p>
    </div>
    <!-- Liste des tâches -->
    <div class="task-scroll-container">
      <mat-list *ngIf="filteredTasks.pending.length > 0">
        <mat-list-item
          *ngFor="let task of filteredTasks.pending"
          class="task-item"
        >
          <div class="task-content">
            <!-- Informations de la tâche -->
            <div class="task-info">
              <div class="task-title-container">
                <span class="task-title">{{ task.title }}</span>
                <span class="task-date">{{ task.dueDate | date }}</span>
              </div>
              <mat-icon class="status-icon">more_horiz</mat-icon>
            </div>

            <!-- Actions sur la tâche -->
            <div class="task-actions">
              <button
                mat-icon-button
                [routerLink]="['/tasks', task.id]"
                color="primary"
              >
                <mat-icon>visibility</mat-icon>
              </button>
              <button
                mat-icon-button
                [routerLink]="['/tasks', task.id, 'edit']"
                color="primary"
              >
                <mat-icon>edit</mat-icon>
              </button>
              <button
                mat-icon-button
                (click)="deleteTask(task.id)"
                color="warn"
              >
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
        </mat-list-item>
      </mat-list>
    </div>
  </div>

  <!-- Colonne 4: Tâches terminées -->
  <div class="task-column">
    <h2>Terminées</h2>
    <!-- Message si aucune tâche -->
    <div
      *ngIf="filteredTasks.done.length === 0 && !loading"
      class="empty-tasks-message"
    >
      <mat-icon>info</mat-icon>
      <p>Aucune tâche terminée</p>
    </div>
    <!-- Liste des tâches -->
    <div class="task-scroll-container">
      <mat-list *ngIf="filteredTasks.done.length > 0">
        <mat-list-item
          *ngFor="let task of filteredTasks.done"
          class="task-item"
        >
          <div class="task-content">
            <!-- Informations de la tâche -->
            <div class="task-info">
              <div class="task-title-container">
                <span class="task-title completed">{{ task.title }}</span>
                <span class="task-date">{{ task.dueDate | date }}</span>
              </div>
              <mat-icon color="primary" class="status-icon"
                >check_circle</mat-icon
              >
            </div>

            <!-- Actions sur la tâche -->
            <div class="task-actions">
              <button
                mat-icon-button
                [routerLink]="['/tasks', task.id]"
                color="primary"
              >
                <mat-icon>visibility</mat-icon>
              </button>
              <button
                mat-icon-button
                [routerLink]="['/tasks', task.id, 'edit']"
                color="primary"
              >
                <mat-icon>edit</mat-icon>
              </button>
              <button
                mat-icon-button
                (click)="deleteTask(task.id)"
                color="warn"
              >
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
        </mat-list-item>
      </mat-list>
    </div>
  </div>

  <!-- Section loading et erreur -->
  <div *ngIf="showLoading || error" class="status-container">
    <div *ngIf="showLoading" class="loading-indicator">
      <mat-spinner></mat-spinner>
    </div>
    <div *ngIf="error" class="error-message">
      {{ error }}
    </div>
  </div>
</div>
